Part One

 "On Shopify, we have exactly 100 sneaker shops, and each of these shops sells only one model of shoe. We want to do some analysis of the average order value (AOV). When we look at orders data over a 30 day window, we naively calculate an AOV of $3145.13. Given that we know these shops are selling sneakers, a relatively affordable item, something seems wrong with our analysis. 

a) Think about what could be going wrong with our calculation. Think about a better way to evaluate this data. 
b) What metric would you report for this dataset?
c) What is its value?"

//---// Python Begins \\---\\

#Import Pandas
import pandas as pd

# Create the dataframe
data = pd.read_csv('shopify_data.csv') 

# Create the statistic demonstrated in the question
AOV = data['order_amount'].mean()
print(AOV)

##### AOV as previously calculated is accurate, 3145.13 is the average order amount

# Show the highest order amounts
data.sort_values('order_amount', ascending = False).head(20)



# The sale between user_id 607 and shop_id 42 appears to be an extreme outlier, likely a business to business sale. 
# Shop_id 78 has something quite strange surrounding its items for sale. Sneakers generally do not cost tens of thousands of dollars. 
# Further analysis needed for both oddities. 



# Create a new column representing the average item cost
data['avg_item_cost'] = data['order_amount'] / data['total_items']
data.head(5)


# Explore if shop 78 sells any items other than its strange 25725$ item. 
shop_78 = data[data['shop_id'] == 78]
shop_78


# Explore if user_id 607 purchases anything other than its immensely large order. 
user_607 = data[data['user_id'] == 607]
user_607


##### The seemingly strange number of 3145.13 results from two peculiar outliers. One outlier is a customer who only made repeated identical extremely large orders; 17 orders at 704,000 each. Likely a business the shop is familiar with on a personal basis. The other outlier results from an item that sells for 25725.00, which could be a type of ultra exclusive shoe, for instance the Nike MAG 2016, or much more likely is something other than a shoe. Either way the shop would be aware of the circumstances of these expensive sales, all the more so since some of the sales are in cash. Over 25 000 in cash is an extremely strange amount of cash under most circumstances. 
##### In both cases, the each outlier belongs to a singular shop_id each, so the shops themselves are likely outliers (meaning, not that relavent for calculating AOV for sneakers across sneaker shops within 3 standard deviations, or in this case even 10 deviations).


##### A better metric would be all orders other than the orders hailing from these two shops. 


# Create a new dataframe bereft of the outliers
aov_modded = data.loc[(data['order_amount'] < 700000) & (data['avg_item_cost'] < 25000)]


# Calculate the new average order value
aov_modded['order_amount'].mean()


##### Thus, a more accurate AOV is 302.58$. 



### Methodology
##### Especially for such small datasets, the Pandas library in Python is my go to tool. On such small datasets, if exploratory analysis needs to be done, Pandas is usually faster to survey with and is more pervasive as a toolset. 
##### Discovering where the error came from was immediate once the highest orders were brought to light. Whereas the rest of the orders come from many sources as one would expect from sneaker shops, and whom all fall in a relatively tightly knit standard distribution for order value, the outliers are so utterly far above this bell curve and belong to only two sources that they are extremely likely to be due to special circumstances instead of being extreme ends of any standard distribution. 
##### Taking out these two outliers outputted an AOV that represents what sneaker shop owners could expect as an average order, which is the statistic I imagine they're looking for. 

##### As AOV is a metric the shop owners are familiar with and is industry standard, I'd keep the metric as AOV, but leave out the two extreme outliers. The AOV I'd offer then is 302.58$
##### If these two outliers need to be classified for the future of standard practice, the user_id 607 is likely a business; meaning it's business to business sales and could be classified differently. And shop_78 either sells something expensive, in addition to shoes, or sells ultra rare shoes. In both cases these sales should be classified as something other than sneakers, by the shop owners. Shop_78 is not benefitting from the initial AOV calculation, as shop_78 deals solely in items no other shop sells and thus the other shop's data doesn't collate to anything meaningful for it. Likely shop_78 would be motivated to classify this 25725 item as something other than sneakers, for its own metrics.



Part Two

1)
SELECT ShipperName, COUNT(ShipperName)
FROM Orders, Shippers
WHERE Orders.ShipperID = Shippers.ShipperID
AND ShipperName LIKE 'Speedy Express'
GROUP BY ShipperName;

Answer: There are 54 orders hailing from Speedy Express. 


2)
SELECT LastName, Orders.EmployeeID, COUNT (Orders.EmployeeID) AS OrdersTotal FROM Orders, Employees
WHERE Orders.EmployeeID = Employees.EmployeeID
GROUP BY LastName, Orders.EmployeeID
ORDER BY COUNT(Orders.EmployeeID) DESC;

Answer: The last name of the customer who had the most orders is Peacock

3)
SELECT ProductName, Count(ProductName) AS OrderTotal FROM OrderDetails, Products, Orders, Customers
WHERE OrderDetails.ProductID = Products.ProductID
AND OrderDetails.OrderID = Orders.OrderID
AND Orders.CustomerID = Customers.CustomerID
AND Country LIKE 'Germany'
GROUP BY ProductName
Order BY Count(ProductName) DESC;

Answer: Gorgonzola Telino is the most common product ordered by customers in Germany, with 5 having been ordered. 

